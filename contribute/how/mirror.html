<!DOCTYPE html>

<html lang="en" dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tails - Set up a Tails mirror</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="icon" href="../../favicon.ico" type="image/x-icon" />

<link rel="stylesheet" href="../../style.css" type="text/css" />

<link rel="stylesheet" href="../../local.css?reload-2021-06-25" type="text/css" />


<script src="../../lib/js/mirror-dispatcher.js" type="text/javascript"></script>









</head>


<body class="en">


<div class="banner" role="banner">
  <a class="tails" href="../../index.html"><span>Tails</span></a>
  <div id="search-and-donate">
    
    
    
    <div class="donate">
      <a href="https://tails.boum.org/donate/?r=topbar" class="en"><span>Donate</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="de"><span>Spenden</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="es"><span>Donar</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="fa"><span>اهدا کردن</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="fr"><span>Faire un don</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="it"><span>Dona</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="pt"><span>Faça uma doação</span></a>
      <a href="https://tails.boum.org/donate/?r=topbar" class="ru"><span>Пожертвовать</span></a>
    </div>
  </div>
</div>



<div class="topbar" role="navigation">
<ul>
  <li><a href="../../index.html">Home</a></li>
  <li><a href="../../about.en.html">How Tails works</a></li>
  <li><a href="../../install.en.html">Get Tails</a></li>
  <li><a href="../../doc.en.html">Documentation</a></li>
  <li><a href="../../support.en.html">Support</a></li>
  <li><a href="../../contribute.en.html">Contribute</a></li>
  <li><a href="../../news.en.html">News</a></li>
  <li><a href="../../jobs.html">Jobs</a></li>
</ul>


</div>



<div class="page">

<div class="pageheader">

<div class="parentlinks">
<ul id="crumbs">
<li><a href="../../index.html"><img alt="home" src="../../lib/home.png"></a></li>







<li><a href="../../contribute.en.html">contribute</a></li>





<li><a href="../how.html">how</a></li>




<li>Set up a Tails mirror</li>

</ul>
</div>



<div class="header">
<span class="title">
Set up a Tails mirror
</span>
</div>






</div>

<div id="pagebody">

<div id="content" role="main">
<div id="intro">

<p>Setting up a Tails BitTorrent or HTTPS mirror helps Tails users
downloading it faster and more reliably.</p>


<div class="toc">
<ol>
	<li class="L1"><a href="#index1h1">BitTorrent</a>
	<ol>
		<li class="L2"><a href="#index1h2">1. Get the latest BitTorrent files</a>
		</li>
		<li class="L2"><a href="#index2h2">2. Share Tails images</a>
		</li>
		<li class="L2"><a href="#index3h2">3. Stay tuned!</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index2h1">HTTPS</a>
	<ol>
		<li class="L2"><a href="#index4h2">Requirements</a>
		</li>
		<li class="L2"><a href="#index5h2">The big picture</a>
		</li>
		<li class="L2"><a href="#index6h2">Pick a hostname for your mirror</a>
		</li>
		<li class="L2"><a href="#index7h2">Manual set up</a>
		</li>
		<li class="L2"><a href="#index8h2">Set up with Puppet</a>
		</li>
		<li class="L2"><a href="#index9h2">Go wild: ask for your mirror to be added to the pool</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index3h1">Talk to us</a>
	</li>
</ol>
</div>


</div>


<h1><a name="index1h1"></a>BitTorrent</h1>

<p>It&#39;s really easy to help Tails users downloading it over BitTorrent...
especially if you are already a BitTorrent user.</p>

<h2><a name="index1h2"></a>1. Get the latest BitTorrent files</h2>

<p>Here are the latest available BitTorrent files:</p>

<div class="map">
<ul>
<li>
<a class="mapitem" href="../../torrents/files/tails-amd64-4.22.img.torrent">tails-amd64-4.22.img.torrent</a>
</li>
<li>
<a class="mapitem" href="../../torrents/files/tails-amd64-4.22.iso.torrent">tails-amd64-4.22.iso.torrent</a>
</li>
</ul>
</div>


<h2><a name="index2h2"></a>2. Share Tails images</h2>

<p>Feed your preferred BitTorrent client with the <code>.torrent</code> files
downloaded at the previous step. Make sure you open and/or forward the
needed ports in your router and/or firewall configuration so that you
are a real seed.</p>

<h2><a name="index3h2"></a>3. Stay tuned!</h2>

<p>As a contributor to Tails availability over BitTorrent, it is very
important you share the very latest published version, and only this
one: users need to be able to quickly download it and upgrade when we
release security fixes, and there is no need to help propagate
outdated versions with security flaws.</p>

<p>A way to do this is to configure software to <a href="./mirror/automatically_download_and_seed_Tails_over_BitTorrent.html">automatically download
and seed Tails over
BitTorrent</a>.</p>

<p>Else, new versions are announced on:</p>

<ul>
<li>our <a href="../../about/contact.en.html#amnesia-news">news list</a></li>
<li>our <a href="/torrents/rss/index.rss">RSS</a> and
<a href="/torrents/rss/index.atom">Atom</a> feeds that announce new available
BitTorrent files.</li>
</ul>


<p><a id="http"></a>
<a id="https"></a></p>

<h1><a name="index2h1"></a>HTTPS</h1>

<h2><a name="index4h2"></a>Requirements</h2>

<p>In order to efficiently help users download Tails images and upgrades, you need:</p>

<ul>
<li><p>a <strong>1Gbps</strong> Internet uplink or faster</p></li>
<li><p><strong>80 GiB</strong> of disk space</p></li>
<li><p>sufficiently privileged access to a <strong>HTTPS</strong> web server</p></li>
<li><p><strong>unfiltered access</strong> to your web server (no GeoIP blocking, no IP bans, no
CAPTCHAs, etc.): we want people everywhere to be able to download Tails</p></li>
<li><p>either a system operated by a professional team, or a high-availability setup</p></li>
</ul>


<p>If you satisfy these practical requirements, please read on!
Else, please consider seeding Tails images over BitTorrent instead.</p>

<h2><a name="index5h2"></a>The big picture</h2>

<p>All downloads are currently served from a diverse pool of mirrors
(see the <a href="../design/mirrors.html">design document</a> for details).</p>

<p>Every HTTPS mirror makes our files available under a fixed URL
(e.g. <code>https://yourdomain.org/pub/tails/</code>)
that contains per-version sub-directories (such as
<code>https://yourdomain.org/pub/tails/stable/tails-i386-lenny-0.6.2/</code>).</p>

<p>Alongside our mirror pool redirecting to mirrors using their own domain, we maintain
a DNS Round Robin pool for the <code>dl.amnesia.boum.org</code> hostname. This pool serves as a
fallback, we add only a few fast and reliable mirrors to it.</p>

<p>We only accept mirrors that provide a SSL certificate deemed valid by
Firefox for the exact hostname used.</p>

<h2><a name="index6h2"></a>Pick a hostname for your mirror</h2>

<p>Your web server needs to answer HTTP and HTTPS requests sent to
a <em>dedicated</em> hostname that is unique, within our mirror pool.
Furthermore, your web server should answer requests sent to <code>dl.amnesia.boum.org</code>
(your mirror could be added to our fallback mirror pool at any moment).</p>

<p>Use a hostname of your choice, under a domain you control.
For example, if you control <code>example.com</code>, you can call your Tails
mirror <code>tails.example.com</code>.</p>

<h2><a name="index7h2"></a>Manual set up</h2>

<div class="tip">
If you are using <a href="https://en.wikipedia.org/wiki/Puppet%5F%28software%29">Puppet</a> to configure
your server infrastructure, consider using the available <a href="./mirror.html#http-puppet">HTTP mirror Puppet
module</a>.
</div>


<h3><a name="index1h3"></a>1. Set up your web server</h3>

<p>Set up a virtual host for the hostname chosen at the
previous step. The virtual host will need to
have indexing enabled.</p>

<p>Files must be served over HTTP and HTTPS. To be helpful in our
context, this requires a certificate that is considered valid by
mainstream web browsers; you can get such a certificate free of charge,
from <a href="https://letsencrypt.org/">Let&#39;s Encrypt</a> for example.</p>

<h4><a name="index1h4"></a>Apache configuration example</h4>

<pre><code>&lt;VirtualHost YOUR_WEBSERVER_IP:80&gt;
   ServerName yourdomain.org
   ServerAlias dl.amnesia.boum.org
   RewriteEngine On
   RewriteRule ^/?(.*) https://%{SERVER_NAME}/pub/$1 [R=permanent,L]
&lt;/VirtualHost&gt;

&lt;VirtualHost YOUR_WEBSERVER_IP:443&gt;
   ServerName yourdomain.org
   ServerAdmin YOUR_EMAIL

   SSLEngine on
   SSLCertificateFile /etc/apache2/ssl/apache.crt
   SSLCertificateKeyFile /etc/apache2/ssl/apache.key

   DocumentRoot /var/www/YOUR_PATH/
   &lt;Directory /var/www/YOUR_PATH/&gt;
      Options Indexes
      AllowOverride None
      IndexIgnore README.html
      IndexOptions FancyIndexing FoldersFirst IgnoreCase NameWidth=50
      IndexOrderDefault Descending Date
   &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre>

<div class="tip">
You can harden this configuration using the
<a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">
Mozilla SSL Configuration Generator</a>.
</div>


<h4><a name="index2h4"></a>Lighttpd configuration example</h4>

<pre><code>$HTTP[&quot;host&quot;] =~ &quot;^(\d+\.)?dl\.amnesia\.boum\.org$&quot; {
    server.document-root = &quot;/var/www/YOUR_PATH/&quot;
    server.dir-listing = &quot;enable&quot;
}
</code></pre>

<h4><a name="index3h4"></a>nginx configuration example</h4>

<pre><code>server {
    server_name dl.amnesia.boum.org;
    root /var/www/YOUR_PATH;
    location / {
        autoindex on;
    }
}
</code></pre>

<h3><a name="index2h3"></a>2. Download the files</h3>

<p>Download a snapshot of the current Tails files:</p>

<pre><code>rsync -rt --delete \
         mirrors.rsync.tails.boum.org::amnesia-archive /var/www/YOUR_PATH/
</code></pre>

<p><a id="cron"></a></p>

<h3><a name="index3h3"></a>3. Schedule the pulling of the files</h3>

<p>Your mirror should sync every hour + a random time (maximum 40 minutes).
Use <code>cron</code> or equivalent to schedule the same <code>rsync</code> command
as above. For example, you can create a file in <code>/etc/cron.d/</code> with
this content:</p>

<pre><code>0 * * * * root sleep $(shuf --input-range=0-2400 --head-count=1) &amp;&amp; flock -n /var/run/lock/tails-mirror-rsync rsync -rt --delete mirrors.rsync.tails.boum.org::amnesia-archive /var/www/YOUR_PATH/
</code></pre>

<p>You can now <a href="./mirror.html#http-pool">ask for your mirror to be added to the pool</a>.</p>

<p><a id="http-puppet"></a></p>

<h2><a name="index8h2"></a>Set up with Puppet</h2>

<p>It is assumed that Puppet is already installed and configured to function well
for your infrastructure.</p>

<h3><a name="index4h3"></a>1. Clone the <code>tails</code> Puppet module</h3>

<p>Clone the module inside the puppet modules&#39; directory of your puppetmaster. On
Debian, this directory should be <code>/etc/puppet/modules</code>.</p>

<pre><code> git clone \
     https://gitlab.tails.boum.org/tails/puppet-tails.git \
     /etc/puppet/modules/tails
</code></pre>

<h3><a name="index5h3"></a>2. Use the tails::mirror class</h3>

<p>On a node where you wish setup the mirror you should include the class like</p>

<pre><code> include tails::mirror
</code></pre>

<p>If you need to adjust any parameters of the class, you should declare it like</p>

<pre><code> class { &#39;tails::mirror&#39;:
   webserver   =&gt; &#39;apache2&#39;,
   server_name =&gt; &#39;tails.example.com&#39;,
   mirror_path =&gt; &#39;/srv/tails/mirror&#39;,
 }
</code></pre>

<h4><a name="index4h4"></a>Configurable parameters</h4>

<p>See the documentation on top of
<a href="https://gitlab.tails.boum.org/tails/puppet-tails/-/blob/master/manifests/mirror.pp">the module</a>.</p>

<p><a id="http-pool"></a></p>

<h2><a name="index9h2"></a>Go wild: ask for your mirror to be added to the pool</h2>

<p>As soon as your web server is ready, please email us its IP address
so that we can add it to the Round Robin pool.</p>

<div class="note">

We will publish your email address, associated with the URL of your
mirror, in a file hosted on our website. If you are not comfortable
with this, give us an email alias that we can publish without
revealing additional information, such as
<emph>webmaster@your-mirror.org</emph>.

</div>


<h1><a name="index3h1"></a>Talk to us</h1>

<p>To get in touch with the team that manages our pool of mirror, write to
<a href="mailto:tails-mirrors@boum.org">tails-mirrors@boum.org</a> (<a href="../../doc/about/openpgp_keys.en.html#mirrors">OpenPGP key</a>).</p>



</div>







</div>

<div id="footer" class="pagefooter" role="contentinfo">

<div id="pageinfo">







<div id="backlinks">
Pages linking to this one:

<a href="../../about/contact.en.html">about/contact</a>

<a href="../../about/contact.de.html">about/contact.de</a>

<a href="../../about/contact.es.html">about/contact.es</a>

<a href="../../about/contact.fr.html">about/contact.fr</a>

<a href="../../about/contact.it.html">about/contact.it</a>

<a href="../../about/contact.pt.html">about/contact.pt</a>

<a href="../../about/contact.ru.html">about/contact.ru</a>

<a href="../../contribute.en.html">contribute</a>

<a href="../../contribute.de.html">contribute.de</a>

<a href="../../contribute.es.html">contribute.es</a>


<span class="popup">...
<span class="balloon">

<a href="../../contribute.fr.html">contribute.fr</a>

<a href="../../contribute.it.html">contribute.it</a>

<a href="../../contribute.pt.html">contribute.pt</a>

<a href="../../contribute.ru.html">contribute.ru</a>

<a href="../../news/report_2015_08.html">news/report 2015 08</a>

<a href="../../news/report_2016_04.html">news/report 2016 04</a>

</span>
</span>

</div>






</div>
<div id="mirrorlist">Mirror: <a href="https://tails.boum.org/ikiwiki.cgi?do=goto&page=contribute/how/mirror">tails.boum.org</a></div>

<!-- from The Amnesic Incognito Live System -->
</div>

</div>

<script type="text/javascript">
  var linkelements = document.querySelectorAll('.use-mirror-pool');
  // Avoid a traceback if mirror-dispatcher.js is not available.
  if (typeof replaceUrlPrefixWithRandomMirror !== "undefined" && linkelements.length > 0) {
    replaceUrlPrefixWithRandomMirror(linkelements);
  }
</script>

</body>
</html>
